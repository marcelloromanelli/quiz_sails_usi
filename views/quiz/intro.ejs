<!DOCTYPE HTML>

<html>

<head>
   <script type="text/javascript" src="/js/jquery.js"></script>

   <script type="text/javascript" src="/js/socket.io.js"></script>
   <script type="text/javascript" src="/js/sails.io.js"></script>
   <script type="text/javascript" src="/js/app.js"></script>

   <script src="js/jquery-ui-1.10.3.custom.min.js"></script>
   <script src="js/jquery.ui.touch-punch.min.js"></script>
   <script src="js/bootstrap-select.js"></script>
   <script src="js/bootstrap-switch.js"></script>
   <script src="js/flatui-checkbox.js"></script>
   <script src="js/flatui-radio.js"></script>
   <script src="js/jquery.tagsinput.js"></script>
   <script src="js/jquery.placeholder.js"></script>
   <script src="js/jquery.stacktable.js"></script>

    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/css/flat-ui.css" rel="stylesheet">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title><%= title %></title>

    <style type="text/css">
        body {
            font: 71%/1.5 Verdana, Sans-Serif;
            background: #eee;
        }

        .space {
            margin-top: 40px;
        }

        .colorRed {
            color: #e74c3c;
        }

        #container {
            margin: 50px auto;
            width: 1376px;
        }

        #keyboard {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        #keyboard li {
            border: 2px solid #bdc3c7;
            color: #34495e;
            background: #fff;
            font-family: "Lato", sans-serif;

            float: left;
            margin: 0 5px 5px 0;
            width: 80px;
            height: 80px;
            line-height: 80px;
            text-align: center;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;

            font-size: 220%;

            -moz-user-select: none;
            -khtml-user-select: none;
            -webkit-user-select: none;
            -o-user-select: none;
        }

        .capslock, .tab, .left-shift {
            clear: left;
        }

        #keyboard .tab, #keyboard .delete {
            width: 140px;
        }

        #keyboard .capslock {
            width: 160px;
        }

        #keyboard .return {
            width: 150px;
        }

        #keyboard .left-shift {
            width: 190px;
        }

        #keyboard .rightright-shift {
            width: 218px;
        }

        #keyboard .right-at {
            border: 2px solid #666;
            width: 118px;
            background: #e74c3c;
            color: white;
        }

        .lastitem {
            margin-right: 0;
        }

        .uppercase {
            text-transform: uppercase;
        }

        #keyboard .space {
            clear: left;
            width: 1295px;
        }

        .on {
            display: none;
        }

        #keyboard li:hover {
            position: relative;
            top: 1px;
            left: 1px;
            border-color: #e74c3c;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span4 offset4">
                <img class="space" width="500px" src="/images/titolo.png"> </img>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center">
                <h2 class="colorRed"><%= res.i18n({phrase: 'welcome_description', locale: lang}) %></h2>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center">
                <h4 class-="colorRed"><%= res.i18n({phrase: 'welcome_email', locale: lang}) %> <br/></h4>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span4 offset4">
                <input style="text-align:center" id="email" type="text" value="@spiritus.ch"/>
            </div>
        </div>

         <div class="row-fluid">
            <div class="span2 offset5">
                <a class="btn btn-large btn-block btn-primary" id="submit"><%= res.i18n({phrase: 'button_submit', locale: lang}) %></a>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12" style="text-align:center;">
                <h4 class="colorRed" id="errorEmail" style="height:30px;"></h4>
            </div>
        </div>
    </div>


    <div id="container" style="margin-top:0px;">
        <ul id="keyboard">
            <li class="symbol"><span class="off">`</span><span class="on">~</span></li>
            <li class="symbol"><span class="off">1</span><span class="on">!</span></li>
            <li class="symbol"><span class="off">2</span><span class="on">@</span></li>
            <li class="symbol"><span class="off">3</span><span class="on">#</span></li>
            <li class="symbol"><span class="off">4</span><span class="on">$</span></li>
            <li class="symbol"><span class="off">5</span><span class="on">%</span></li>
            <li class="symbol"><span class="off">6</span><span class="on">^</span></li>
            <li class="symbol"><span class="off">7</span><span class="on">&amp;</span></li>
            <li class="symbol"><span class="off">8</span><span class="on">*</span></li>
            <li class="symbol"><span class="off">9</span><span class="on">(</span></li>
            <li class="symbol"><span class="off">0</span><span class="on">)</span></li>
            <li class="symbol"><span class="off">-</span><span class="on">_</span></li>
            <li class="symbol"><span class="off">=</span><span class="on">+</span></li>
            <li class="delete lastitem">delete</li>
            <li class="tab">tab</li>
            <li class="letter">q</li>
            <li class="letter">w</li>
            <li class="letter">e</li>
            <li class="letter">r</li>
            <li class="letter">t</li>
            <li class="letter">y</li>
            <li class="letter">u</li>
            <li class="letter">i</li>
            <li class="letter">o</li>
            <li class="letter">p</li>
            <li class="symbol"><span class="off">[</span><span class="on">{</span></li>
            <li class="symbol"><span class="off">]</span><span class="on">}</span></li>
            <li class="symbol lastitem"><span class="off">\</span><span class="on">|</span></li>
            <li class="capslock">caps lock</li>
            <li class="letter">a</li>
            <li class="letter">s</li>
            <li class="letter">d</li>
            <li class="letter">f</li>
            <li class="letter">g</li>
            <li class="letter">h</li>
            <li class="letter">j</li>
            <li class="letter">k</li>
            <li class="letter">l</li>
            <li class="symbol"><span class="off">;</span><span class="on">:</span></li>
            <li class="symbol"><span class="off">'</span><span class="on">&quot;</span></li>
            <li class="return lastitem">return</li>
            <li class="left-shift">shift</li>
            <li class="letter">z</li>
            <li class="letter">x</li>
            <li class="letter">c</li>
            <li class="letter">v</li>
            <li class="letter">b</li>
            <li class="letter">n</li>
            <li class="letter">m</li>
            <li class="symbol"><span class="off">,</span><span class="on">&lt;</span></li>
            <li class="symbol"><span class="off">.</span><span class="on">&gt;</span></li>
            <li class="symbol"><span class="off">/</span><span class="on">?</span></li>
            <li class="right-shift lastitem">shift</li>
            <li class="right-at">@</li>
            <li class="space lastitem">&nbsp;</li>
        </ul>
    </div>

    <script>
        var lang = "<%= lang%>"
        $(document).ready(function() {
            $('#submit').click(function () {
                if($('#email').val() == mail) {
                    $('#errorEmail').html(invalidEmail)
                } else {
                    socket.request('/email', {email: $('#email').val()}, function(res) {
                        if(res.success) {
                            window.location = "/quiz/" + lang + "/" + $('#email').val()
                        } else {
                            $('#errorEmail').html(invalidEmail)
                        }
                    })
                }
            })
        })
    </script>

    <script>
        var invalidEmail = "<%= res.i18n({phrase: 'welcome_invalidEmail', locale: lang}) %>"
        var prefix = ""
        var mail = "@spiritus.ch"

        $(function(){
            $(this).bind("contextmenu", function(e) {
                e.preventDefault();
            });

            var $write = $('#email'),
                shift = false,
                capslock = false;

            $('#keyboard li').click(function(){
                var $this = $(this),
                    character = $this.html(); // If it's a lowercase letter, nothing happens to this variable

                // Shift keys
                if ($this.hasClass('left-shift') || $this.hasClass('right-shift')) {
                    $('.letter').toggleClass('uppercase');
                    $('.symbol span').toggle();

                    shift = (shift === true) ? false : true;
                    capslock = false;
                    return false;
                }

                // Caps lock
                if ($this.hasClass('capslock')) {
                    $('.letter').toggleClass('uppercase');
                    capslock = true;
                    return false;
                }

                // Delete
                if ($this.hasClass('delete')) {
                    prefix = prefix.substr(0, prefix.length - 1)
                    $write.val(prefix +  mail);
                    return false;
                }

                // Special characters
                if ($this.hasClass('symbol')) character = $('span:visible', $this).html();
                if ($this.hasClass('space')) character = ' ';
                if ($this.hasClass('tab')) character = "\t";
                if ($this.hasClass('return')) {
                    $('#submit').click()
                    character = ''
                }

                // Uppercase letter
                if ($this.hasClass('uppercase')) character = character.toUpperCase();

                // Remove shift once a key is clicked.
                if (shift === true) {
                    $('.symbol span').toggle();
                    if (capslock === false) $('.letter').toggleClass('uppercase');

                    shift = false;
                }

                // Add the character
                prefix = prefix + character
                $write.val(prefix + mail);
            });
        });
    </script>
</body>
</html>